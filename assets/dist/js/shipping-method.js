(()=>{"use strict";!function(t,e,a){let o="";function n(){me(".woocommerce-shipping-totals").on("change",(n=>{"oca-shipping-branch-selector"===n.target?.id&&async function(n){const c=me(n.target),i=me(n.target.options[n.target.selectedIndex]),s=n.target.value;if(s&&s!==o)try{const n={id:parseInt(s),name:i.attribute("data-name"),street:i.attribute("data-street"),streetNumber:i.attribute("data-street-number"),floor:i.attribute("data-floor"),apt:i.attribute("data-apt"),city:i.attribute("data-city"),postcode:i.attribute("data-postcode"),phone:i.attribute("data-phone"),hours:i.attribute("data-hours"),type:i.attribute("data-type")};c.styles({opacity:.75}),c.disable();let d=await fetch(`${e.store_url}/wp-json/oca-for-woocommerce/v1/shipping-branch`,{method:"PUT",headers:{"Content-Type":"application/json","X-WP-Nonce":e.ajax_nonce},body:JSON.stringify(n)});if(c.styles({opacity:1}),c.enable(),!d.ok)return void alert(a.generic_error_try_again);o=s,t(document.body).trigger("update_checkout"),async function(){if(!e.page_is_single_product&&!e.page_is_cart)return;const a=me(".cart_totals");if(!a)return;const o={action:"woocommerce_get_cart_totals",nonce:e.ajax_nonce};a.styles({opacity:.75}),a.disable();let n=await fetch(e.ajax_url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r(o)});if(n.ok){n=await n.text();const e=document.createElement("div");e.innerHTML=n,a.replaceWith(...e.childNodes),t(document.body).trigger("updated_cart_totals")}a.styles({opacity:1}),a.enable()}()}catch(t){alert(a.generic_error_try_again)}}(n)}))}n(),t(document.body).on("updated_checkout",n),t(document.body).on("updated_cart_totals",n);const r=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a="";for(let o in t)if(t.hasOwnProperty(o)){const n=t[o],c=e?`${e}[${o}]`:o;"object"==typeof n&&null!==n?a+=r(n,c):(a.length>0&&(a+="&"),a+=`${encodeURIComponent(c)}=${encodeURIComponent(n)}`)}return a}}(jQuery,wc_oca_settings,wc_oca_translation_texts)})();