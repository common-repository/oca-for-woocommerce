(()=>{"use strict";!function(e,o,t){const n=me("#oca-view-shipping-label-pdf-a4");let c="",i="";n&&n.on("click",(function(r){i&&!i.closed?i.focus():c?i=o.popupWithIframe(c,"OCA Etiqueta envío"):o.sendRequest("GET",`/orders/${e.order_id}/shipping-labels?format=pdf&size=A4`,(e=>{if(!e.content)return void o.addNotice(t.generic_error_try_again,"error");let n=o.b64ToBlob(e.content,"application/pdf");c=URL.createObjectURL(n),i=o.popupWithIframe(c,"OCA Etiqueta envío")}),{button:n})}));const r=me("#oca-view-shipping-label-pdf-10x15");let a="",d="";r&&r.on("click",(function(n){d&&!d.closed?d.focus():a?d=o.popupWithIframe(a,"OCA Etiqueta envío"):o.sendRequest("GET",`/orders/${e.order_id}/shipping-labels?format=pdf&size=10x15`,(e=>{if(!e.content)return void o.addNotice(t.generic_error_try_again,"error");let n=o.b64ToBlob(e.content,"application/pdf");a=URL.createObjectURL(n),d=o.popupWithIframe(a,"OCA Etiqueta envío")}),{button:r})}));const s=me("#oca-download-shipping-label-pdf-a4");let p="";s&&s.on("click",(function(n){p?p.dispatchEvent(new MouseEvent("click")):o.sendRequest("GET",`/orders/${e.order_id}/shipping-labels?format=pdf&size=A4`,(n=>{n.content?(p=document.createElement("a"),p.download=`OCA-${e.order_id}-${e.oca_number}.pdf`,p.href="data:application/pdf;base64,"+n.content,p.dispatchEvent(new MouseEvent("click"))):o.addNotice(t.generic_error_try_again,"error")}),{button:s})}));const l=me("#oca-download-shipping-label-pdf-10x15");let u="";l&&l.on("click",(function(n){u?u.dispatchEvent(new MouseEvent("click")):o.sendRequest("GET",`/orders/${e.order_id}/shipping-labels?format=pdf&size=10x15`,(n=>{n.content?(u=document.createElement("a"),u.download=`OCA-${e.order_id}-${e.oca_number}.pdf`,u.href="data:application/pdf;base64,"+n.content,u.dispatchEvent(new MouseEvent("click"))):o.addNotice(t.generic_error_try_again,"error")}),{button:l})}));const _=me("#oca-download-shipping-label-zpl");let f="";_&&_.on("click",(function(n){f?f.dispatchEvent(new MouseEvent("click")):o.sendRequest("GET",`/orders/${e.order_id}/shipping-labels?format=zpl`,(n=>{n.content?(f=document.createElement("a"),f.download=`OCA-${e.order_id}-${e.oca_number}.zpl`,f.href="data:text/plain,"+n.content,f.dispatchEvent(new MouseEvent("click"))):o.addNotice(t.generic_error_try_again,"error")}),{button:_,data:{order_id:e.order_id}})}));const m=me("#oca-view-tracking");let b="";m&&m.on("click",(function(t){b&&!b.closed?b.focus():b=o.popupWithUrl("https://www9.oca.com.ar/OEPTrackingWeb/detalleenviore.asp?numero="+e.oca_tracking_number,"OCA Order tracking")}));const g=me("#oca-process-order");g&&g.on("click",(function(t){o.sendRequest("POST",`/orders/${e.order_id}/process`,(()=>window.location.reload()),{button:g,body:{force:!0}})}));const h=me("#oca-send-tracking-mail");h&&h.on("click",(function(n){o.sendRequest("POST",`/orders/${e.order_id}/mails/tracking/send`,(()=>o.addNotice(t.mail_sent)),{button:h})}));const k=me("#oca-cancel-order");k&&k.on("click",(function(t){o.sendRequest("POST",`/orders/${e.order_id}/cancel`,(()=>window.location.reload()),{button:k})}));const w=me("#set-method-to-oca");w&&w.on("click",(function(n){o.sendRequest("GET",`/orders/${e.order_id}/quotes`,(n=>{if(!n.id)return void o.addNotice(t.no_quote_found,"error");let c=t.new_quote_alert.replace("{{shipping_name}}",n.name);c=c.replace("{{shipping_price}}",n.price);confirm(c)&&o.sendRequest("POST",`/orders/${e.order_id}/set-oca`,(()=>window.location.reload()),{button:w,body:{id:n.id,name:n.name,type:n.type,price:n.price,hiddenPrice:me("#hide_shipping_cost").checked}})}),{button:w})}));const E=me("#oca-packages-quantity");if(E){const n=me(".edit-packages-button");n.on("click",(function(c){halt(c);const i=parseInt(E.value);i<1?o.addNotice(t.invalid_package_number,"error"):o.sendRequest("POST",`/orders/${e.order_id}/packages`,(()=>{o.addNotice(t.packages_qty_updated),setTimeout((function(){window.location.reload()}),1500)}),{body:{quantity:i},button:n})}))}}(wc_oca_settings,ocaHelper,wc_oca_translation_texts)})();